<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>امتحان اللغة العربية - جامعة صنعاء</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* جميع الأنماط تبقى كما هي مع تعديلات طفيفة */
        :root {
            --primary-color: #2c5282;
            --secondary-color: #4299e1;
            --accent-color: #e53e3e;
            --success-color: #38a169;
            --warning-color: #d69e2e;
            --light-color: #f7fafc;
            --dark-color: #2d3748;
            --bg-color: #ffffff;
            --text-color: #2d3748;
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
            --transition: all 0.3s ease;
        }

        [data-theme="dark"] {
            --bg-color: #1a202c;
            --text-color: #e2e8f0;
            --card-bg: #2d3748;
            --light-color: #4a5568;
            --dark-color: #171923;
            --border-color: #4a5568;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            --primary-color: #4299e1;
            --secondary-color: #63b3ed;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
            direction: rtl;
        }

        /* تحسين الوضع الليلي ليشمل كامل المساحة */
        [data-theme="dark"] body {
            background: #0f1721;
        }
        
        [data-theme="dark"] .container {
            background: transparent;
        }
        
        [data-theme="dark"] .exam-header,
        [data-theme="dark"] .instructions,
        [data-theme="dark"] .exam-controls,
        [data-theme="dark"] .questions-nav-grid,
        [data-theme="dark"] .question-container,
        [data-theme="dark"] .result-card,
        [data-theme="dark"] .review-section,
        [data-theme="dark"] .modal-content {
            background: var(--card-bg);
        }
        
        [data-theme="dark"] .option {
            background: #2d3748;
        }
        
        [data-theme="dark"] .option-marker {
            background: #4a5568;
            color: #e2e8f0;
        }

        /* شريط التنقل المتحرك - تم تصغير حجم الخط */
        .navbar {
            background: linear-gradient(90deg, var(--primary-color), #2b6cb0);
            color: white;
            padding: 0.8rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            animation: slideDown 0.5s ease;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* تصغير حجم الخط في الترويسة */
        .logo h1 {
            font-size: 1.3rem;
            margin-bottom: 0.2rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            animation: fadeIn 1s ease;
        }

        .logo p {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .nav-controls {
            display: flex;
            gap: 0.8rem;
            align-items: center;
        }

        .icon-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 38px;
            height: 38px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            font-size: 1rem;
        }

        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px) rotate(5deg);
        }

        /* الحاوية الرئيسية */
        .container {
            max-width: 1100px;
            margin: 1.5rem auto;
            padding: 0 1.5rem;
            animation: fadeIn 0.8s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .screen {
            display: none;
            animation: slideUp 0.6s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* شاشة البداية - نقل مربع الأسئلة للأمام */
        .exam-header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: var(--card-bg);
            border-radius: 18px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            animation: fadeIn 0.8s ease;
        }

        .exam-header h1 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            position: relative;
            display: inline-block;
        }

        .exam-header h1:after {
            content: '';
            position: absolute;
            bottom: -8px;
            right: 50%;
            transform: translateX(50%);
            width: 70px;
            height: 3px;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
            border-radius: 2px;
        }

        .university-info {
            margin: 1.5rem 0;
            padding: 1.2rem;
            background: rgba(66, 153, 225, 0.05);
            border-radius: 12px;
            border-right: 4px solid var(--secondary-color);
        }

        .university-info h3 {
            margin: 0.6rem 0;
            color: var(--secondary-color);
            font-size: 1.1rem;
        }

        .student-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1.2rem;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 2px solid rgba(66, 153, 225, 0.2);
        }

        .info-item {
            background: linear-gradient(135deg, rgba(66, 153, 225, 0.05), rgba(44, 82, 130, 0.05));
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid rgba(66, 153, 225, 0.1);
            transition: var(--transition);
        }

        .info-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(66, 153, 225, 0.1);
        }

        .info-item p:first-child {
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.4rem;
            font-size: 0.9rem;
        }

        .info-item p:last-child {
            color: var(--text-color);
            font-size: 1rem;
        }

        .instructions {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 18px;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .instructions h3 {
            color: var(--secondary-color);
            margin-bottom: 1.2rem;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }

        .instructions ul {
            list-style: none;
            padding-right: 0;
        }

        .instructions li {
            margin-bottom: 0.8rem;
            padding-right: 1.8rem;
            position: relative;
            font-size: 1rem;
        }

        .instructions li:before {
            content: '✓';
            position: absolute;
            right: 0;
            color: var(--success-color);
            font-weight: bold;
            font-size: 1rem;
            background: rgba(56, 161, 105, 0.1);
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* الأزرار */
        .btn {
            padding: 0.9rem 1.8rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            font-family: 'Cairo', sans-serif;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .btn:before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: translateX(-100%);
        }

        .btn:hover:before {
            animation: shine 1s;
        }

        @keyframes shine {
            100% { transform: translateX(100%); }
        }

        .start-btn {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            font-size: 1.2rem;
            padding: 1.1rem 2.5rem;
            margin: 2rem auto;
            display: block;
            min-width: 240px;
        }

        .start-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(66, 153, 225, 0.3);
        }

        .primary-btn {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            border: none;
        }

        .primary-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(66, 153, 225, 0.25);
        }

        .secondary-btn {
            background: transparent;
            color: var(--secondary-color);
            border: 2px solid var(--secondary-color);
        }

        .secondary-btn:hover {
            background: var(--secondary-color);
            color: white;
            transform: translateY(-2px);
        }

        .danger-btn {
            background: linear-gradient(135deg, var(--accent-color), #c53030);
            color: white;
            border: none;
        }

        .danger-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(229, 62, 62, 0.25);
        }

        .success-btn {
            background: linear-gradient(135deg, var(--success-color), #2f855a);
            color: white;
            border: none;
        }

        .success-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(56, 161, 105, 0.25);
        }

        /* شاشة الامتحان - إعادة ترتيب العناصر */
        .exam-controls {
            background: var(--card-bg);
            padding: 1.8rem;
            border-radius: 16px;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            animation: fadeIn 0.6s ease;
        }

        .progress-container {
            margin-bottom: 1.2rem;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--light-color);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
            width: 0%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 4px;
            position: relative;
        }

        .progress-fill:after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3));
            animation: progressShine 2s infinite;
        }

        @keyframes progressShine {
            0% { right: 0; }
            100% { right: 100%; }
        }

        .exam-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1.2rem;
            margin-top: 1.2rem;
        }

        .timer {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--accent-color);
            background: var(--card-bg);
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 0.6rem;
            border: 2px solid rgba(229, 62, 62, 0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        /* شبكة التنقل بين الأسئلة */
        .questions-nav-grid {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 16px;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            animation: fadeIn 0.6s ease;
        }

        .questions-nav-grid h3 {
            color: var(--secondary-color);
            margin-bottom: 1.2rem;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
        }

        .questions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 0.8rem;
            max-height: 300px;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .question-nav-btn {
            width: 45px;
            height: 45px;
            border-radius: 8px;
            border: 2px solid var(--border-color);
            background: var(--bg-color);
            color: var(--text-color);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .question-nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.15);
            border-color: var(--secondary-color);
        }

        .question-nav-btn.current {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            border-color: var(--secondary-color);
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.3);
        }

        .question-nav-btn.answered {
            background: rgba(56, 161, 105, 0.1);
            color: var(--success-color);
            border-color: var(--success-color);
        }

        .question-nav-btn.unanswered {
            background: rgba(214, 158, 46, 0.1);
            color: var(--warning-color);
            border-color: var(--warning-color);
        }

        /* منطقة الأسئلة - تم نقلها للأمام */
        .question-container {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 18px;
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
            animation: slideUp 0.5s ease;
            order: -1; /* يجعل السؤال يظهر أولاً */
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .question-number {
            color: white;
            font-weight: 800;
            font-size: 1.1rem;
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            padding: 0.5rem 1.1rem;
            border-radius: 50px;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.3);
        }

        .question-text {
            font-size: 1.3rem;
            margin-bottom: 1.8rem;
            line-height: 1.7;
            color: var(--text-color);
            font-weight: 600;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.9rem;
            margin-bottom: 1.8rem;
        }

        @media (min-width: 768px) {
            .options-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        .option {
            background: var(--bg-color);
            padding: 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .option:before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 4px;
            height: 100%;
            background: var(--secondary-color);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .option:hover {
            transform: translateX(-4px);
            border-color: var(--secondary-color);
            box-shadow: 0 6px 20px rgba(66, 153, 225, 0.15);
        }

        .option:hover:before {
            opacity: 1;
        }

        .option.selected {
            border-color: var(--success-color);
            background: rgba(56, 161, 105, 0.05);
            transform: translateX(-4px);
        }

        .option.selected:before {
            background: var(--success-color);
            opacity: 1;
        }

        .option.correct {
            border-color: var(--success-color);
            background: rgba(56, 161, 105, 0.1);
            animation: pulse 0.5s;
        }

        .option.incorrect {
            border-color: var(--accent-color);
            background: rgba(229, 62, 62, 0.1);
        }

        .option-marker {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            background: var(--light-color);
            color: var(--text-color);
            flex-shrink: 0;
            transition: all 0.3s;
            font-size: 0.95rem;
        }

        .option.selected .option-marker {
            background: var(--success-color);
            color: white;
            box-shadow: 0 4px 12px rgba(56, 161, 105, 0.3);
        }

        .option-text {
            flex: 1;
            font-size: 1.05rem;
            font-weight: 500;
        }

        /* تعديل أزرار التنقل لجعل "التالي" على يسار "السابق" */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            gap: 1rem;
            flex-direction: row-reverse; /* هذا يجعل "التالي" على اليسار و"السابق" على اليمين */
        }

        .navigation-buttons .btn {
            min-width: 140px;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-btn-group {
            display: flex;
            gap: 0.8rem;
            width: 100%;
            justify-content: center;
        }

        /* تنبيه الأسئلة غير المحلولة */
        .unanswered-alert {
            background: linear-gradient(135deg, rgba(214, 158, 46, 0.1), rgba(214, 158, 46, 0.05));
            border: 2px solid var(--warning-color);
            color: var(--warning-color);
            padding: 0.9rem 1.2rem;
            border-radius: 10px;
            margin-top: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-weight: 600;
            animation: fadeIn 0.5s ease;
        }

        /* شاشة النتائج */
        .results-header {
            text-align: center;
            margin-bottom: 2.5rem;
            animation: fadeIn 0.8s ease;
        }

        .results-header h1 {
            color: var(--secondary-color);
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .score-display {
            position: relative;
            width: 260px;
            height: 260px;
            margin: 1.5rem auto;
        }

        .score-circle {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .circle-bg, .circle-progress {
            fill: none;
            stroke-width: 10;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .circle-bg {
            stroke: var(--light-color);
        }

        .circle-progress {
            stroke: var(--secondary-color);
            stroke-dasharray: 800;
            stroke-dashoffset: 800;
            transition: stroke-dashoffset 2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .score-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .score-text h2 {
            font-size: 2.5rem;
            color: var(--secondary-color);
            margin-bottom: 0.4rem;
        }

        .score-text p {
            font-size: 1.3rem;
            color: var(--text-color);
        }

        .results-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .result-card {
            background: var(--card-bg);
            padding: 1.8rem;
            border-radius: 16px;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-5px);
        }

        .result-card h3 {
            margin-bottom: 1rem;
            color: var(--secondary-color);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
        }

        .stat {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--text-color);
        }

        .results-controls {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
        }

        /* قسم مراجعة الإجابات - تظهر الإجابات الخطأ فقط */
        .review-section {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 18px;
            margin-top: 2.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            display: none;
            animation: slideUp 0.5s ease;
        }

        .review-section h3 {
            color: var(--secondary-color);
            margin-bottom: 1.8rem;
            text-align: center;
            font-size: 1.5rem;
        }

        .review-list {
            display: flex;
            flex-direction: column;
            gap: 1.8rem;
        }

        .review-item {
            background: var(--bg-color);
            padding: 1.8rem;
            border-radius: 16px;
            border-right: 5px solid var(--accent-color);
            transition: transform 0.3s ease;
            border: 1px solid var(--border-color);
        }

        .review-item:hover {
            transform: translateX(-4px);
        }

        .review-question {
            font-weight: 700;
            margin-bottom: 1.2rem;
            color: var(--text-color);
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .review-answers {
            display: flex;
            flex-direction: column;
            gap: 0.9rem;
        }

        .answer-item {
            padding: 0.9rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            transition: all 0.3s;
        }

        .answer-item.user-answer {
            background: rgba(229, 62, 62, 0.08);
            border-right: 4px solid var(--accent-color);
        }

        .answer-item.correct-answer {
            background: rgba(56, 161, 105, 0.08);
            border-right: 4px solid var(--success-color);
        }

        .answer-item i {
            font-size: 1.1rem;
        }

        /* التذييل */
        .footer {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(90deg, var(--primary-color), #2b6cb0);
            color: white;
            margin-top: 3rem;
            box-shadow: 0 -4px 12px rgba(0,0,0,0.1);
        }

        .footer p {
            margin: 0.6rem 0;
            font-size: 0.9rem;
        }

        /* النوافذ المنبثقة */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 18px;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            border: 1px solid var(--border-color);
            animation: slideUp 0.4s ease;
        }

        .modal-content h3 {
            color: var(--secondary-color);
            margin-bottom: 1.2rem;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-size: 1.3rem;
        }

        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 1.2rem;
            margin-top: 1.8rem;
        }

        /* تصميم متجاوب */
        @media (max-width: 768px) {
            .container {
                margin: 1rem auto;
                padding: 0 1rem;
            }
            
            .exam-header h1 {
                font-size: 1.5rem;
            }
            
            .student-info {
                grid-template-columns: 1fr;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .option {
                padding: 1rem;
            }
            
            .option-text {
                font-size: 1rem;
            }
            
            .questions-grid {
                grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            }
            
            .question-nav-btn {
                width: 40px;
                height: 40px;
                font-size: 0.9rem;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 0.8rem;
            }
            
            .navigation-buttons .btn {
                width: 100%;
            }
            
            .results-controls {
                flex-direction: column;
                gap: 1rem;
            }
            
            .results-controls .btn {
                width: 100%;
            }
            
            .score-display {
                width: 220px;
                height: 220px;
            }
            
            .score-text h2 {
                font-size: 2rem;
            }
            
            .stat {
                font-size: 2rem;
            }
            
            .timer {
                font-size: 1.1rem;
                padding: 0.5rem 1rem;
            }
            
            .nav-btn-group {
                flex-direction: column;
            }
        }

        /* تأثيرات الكونفيتي */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f0f;
            opacity: 0;
            z-index: 9999;
            pointer-events: none;
        }

        /* زر العودة إلى الأعلى */
        .scroll-top-btn {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 100;
            transition: var(--transition);
            opacity: 0;
            visibility: hidden;
        }

        .scroll-top-btn.visible {
            opacity: 1;
            visibility: visible;
        }

        .scroll-top-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 18px rgba(66, 153, 225, 0.4);
        }

        /* تحسينات الوضع الليلي */
        body {
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        .theme-transition {
            transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease;
        }
    </style>
</head>
<body>
    <!-- زر العودة إلى الأعلى -->
    <button id="scrollTopBtn" class="scroll-top-btn">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- شريط التنقل - تم حذف زر المساعدة -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <h1><i class="fas fa-university"></i> ملتقى الطالب الجامعي</h1>
                <p>جامعة صنعاء - كلية الإعلام</p>
            </div>
            <div class="nav-controls">
                <button id="darkModeToggle" class="icon-btn" title="الوضع الليلي">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- الشاشة الرئيسية -->
    <main class="container">
        <!-- شاشة البداية -->
        <section id="startScreen" class="screen active">
            <div class="exam-header">
                <h1><i class="fas fa-book-open"></i> امتحان اللغة العربية</h1>
                
                <div class="university-info">
                    <h3>اللجنة العلمية - الدفعة 35</h3>
                    <h3>دكتور المقرر: رصين صالح الرصين</h3>
                </div>
                
                <div class="student-info">
                    <div class="info-item">
                        <p>المقرر</p>
                        <p>اللغة العربية</p>
                    </div>
                    <div class="info-item">
                        <p>المستوى</p>
                        <p>الأول</p>
                    </div>
                    <div class="info-item">
                        <p>عدد الأسئلة</p>
                        <p>30 سؤال</p>
                    </div>
                    <div class="info-item">
                        <p>الوقت المخصص</p>
                        <p>60 دقيقة</p>
                    </div>
                </div>
            </div>
            
            <div class="instructions">
                <h3><i class="fas fa-info-circle"></i> تعليمات الامتحان:</h3>
                <ul>
                    <li>اختر الإجابة الصحيحة بالنقر على الخيار المناسب</li>
                    <li>يمكنك تغيير إجابتك قبل إنهاء الامتحان </li>
                    <li>سيتم تنبيهك عن الأسئلة التي لم تتم الإجابة عليها</li>
                    <li>الوقت المخصص: 60 دقيقة</li>
                    <li>لبدء الامتحان، اضغط على زر "ابدأ الامتحان"</li>
                </ul>
            </div>
            
            <button id="startExamBtn" class="btn start-btn">
                <i class="fas fa-play-circle"></i> ابدأ الامتحان
            </button>
            
            <div style="text-align: center; margin-top: 1.5rem; color: var(--text-color); opacity: 0.8; font-size: 1rem;">
                <p><i class="fas fa-lightbulb"></i> تذكر: اجب مستعينًا بالله تعالى على الأسئلة التالية</p>
            </div>
        </section>

        <!-- شاشة الامتحان -->
        <section id="examScreen" class="screen">
            <!-- مربع الأسئلة في المقدمة -->
            <div class="question-container">
                <div class="question-header">
                    <div id="questionNumber" class="question-number">س1</div>
                    <div id="questionStatus" style="color: var(--warning-color); font-weight: bold;">
                        <i class="fas fa-star"></i> جديد
                    </div>
                </div>
                
                <h2 id="questionText" class="question-text"></h2>
                
                <div id="optionsContainer" class="options-container">
                    <!-- سيتم تعبئة الخيارات ديناميكياً -->
                </div>
                
                <div class="navigation-buttons">
                    <button id="nextBtn" class="btn primary-btn" style="flex: 1;">
                        التالي <i class="fas fa-arrow-left"></i>
                    </button>
                    <button id="prevBtn" class="btn secondary-btn" style="flex: 1;">
                        <i class="fas fa-arrow-right"></i> السابق
                    </button>
                </div>
            </div>

            <!-- شبكة التنقل بين الأسئلة -->
            <div class="questions-nav-grid">
                <h3><i class="fas fa-layer-group"></i> التنقل بين الأسئلة</h3>
                <div id="questionsGrid" class="questions-grid">
                    <!-- سيتم تعبئة أزرار الأسئلة ديناميكياً -->
                </div>
            </div>
            
            <div class="exam-controls">
                <div class="progress-container">
                    <div class="progress-info">
                        <span id="progressText">السؤال 1 من 30</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill"></div>
                    </div>
                </div>
                
                <div class="exam-stats">
                    <div id="timer" class="timer">
                        <i class="fas fa-clock"></i>
                        <span>60:00</span>
                    </div>
                    <button id="endExamBtn" class="btn danger-btn">
                        <i class="fas fa-flag-checkered"></i> إنهاء الاختبار
                    </button>
                </div>
            </div>
            
            <!-- تنبيه الأسئلة غير المحلولة -->
            <div id="unansweredAlert" class="unanswered-alert" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i>
                <span id="unansweredCount">0</span> أسئلة لم تتم الإجابة عليها
            </div>
        </section>

        <!-- شاشة النتائج -->
        <section id="resultsScreen" class="screen">
            <div class="results-header">
                <h1><i class="fas fa-chart-line"></i> نتائج الامتحان</h1>
                
                <div class="score-display">
                    <div class="score-circle">
                        <svg width="260" height="260">
                            <circle class="circle-bg" cx="130" cy="130" r="120"></circle>
                            <circle id="scoreCircle" class="circle-progress" cx="130" cy="130" r="120"></circle>
                        </svg>
                    </div>
                    <div class="score-text">
                        <h2 id="finalScore">0/30</h2>
                        <p id="percentage">0%</p>
                        <p id="grade" style="font-size: 1.1rem; color: var(--text-color); margin-top: 0.4rem;"></p>
                    </div>
                </div>
            </div>
            
            <div class="results-details">
                <div class="result-card">
                    <h3><i class="fas fa-check-circle"></i> الإجابات الصحيحة</h3>
                    <p id="correctAnswers" class="stat">0</p>
                </div>
                <div class="result-card">
                    <h3><i class="fas fa-times-circle"></i> الإجابات الخاطئة</h3>
                    <p id="wrongAnswers" class="stat">0</p>
                </div>
                <div class="result-card">
                    <h3><i class="fas fa-clock"></i> الوقت المستغرق</h3>
                    <p id="timeTaken" class="stat">0:00</p>
                </div>
                <div class="result-card">
                    <h3><i class="fas fa-chart-bar"></i> النسبة المئوية</h3>
                    <p id="scorePercentage" class="stat">0%</p>
                </div>
            </div>
            
            <div class="results-controls">
                <button id="reviewBtn" class="btn secondary-btn">
                    <i class="fas fa-list-check"></i> مراجعة الإجابات الخاطئة
                </button>
                <button id="newTestBtn" class="btn primary-btn">
                    <i class="fas fa-redo"></i> اختبار جديد
                </button>
                <button id="retryBtn" class="btn success-btn">
                    <i class="fas fa-sync-alt"></i> إعادة نفس الاختبار
                </button>
            </div>
            
            <!-- قسم مراجعة الإجابات - تظهر الإجابات الخطأ فقط -->
            <div id="reviewSection" class="review-section">
                <h3><i class="fas fa-clipboard-check"></i> مراجعة الإجابات الخاطئة</h3>
                <div id="wrongAnswersList" class="review-list">
                    <!-- سيتم تعبئة الإجابات الخاطئة هنا -->
                </div>
                <div id="noWrongAnswers" style="text-align: center; padding: 3rem; color: var(--success-color); display: none;">
                    <i class="fas fa-check-circle" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                    <h3 style="color: var(--success-color);">ممتاز! لم تكن لديك إجابات خاطئة</h3>
                    <p style="color: var(--text-color); opacity: 0.8; margin-top: 1rem;">جميع إجاباتك كانت صحيحة</p>
                </div>
                <div style="text-align: center; margin-top: 2rem;">
                    <button id="closeReviewBtn" class="btn secondary-btn">
                        <i class="fas fa-times"></i> إغلاق المراجعة
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- تذييل الصفحة -->
    <footer class="footer">
        <p>اللجنة العلمية لكلية الإعلام 2026©</p>
        <p>امتحان اللغة العربية - المستوى الأول</p>
        <p>تم تطوير هذا الموقع لأغراض تعليمية وتدريبية</p>
    </footer>

    <!-- نموذج تأكيد إنهاء الاختبار فقط -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-exclamation-triangle"></i> تأكيد إنهاء الاختبار</h3>
            <p style="color: var(--text-color); margin-bottom: 1.5rem; line-height: 1.6;">
                هل أنت متأكد أنك تريد إنهاء الاختبار؟<br>
                لديك <span id="remainingQuestions">0</span> أسئلة لم تتم الإجابة عليها.
            </p>
            <div class="modal-buttons">
                <button id="cancelEndBtn" class="btn secondary-btn">
                    <i class="fas fa-times"></i> إلغاء
                </button>
                <button id="confirmEndBtn" class="btn danger-btn">
                    <i class="fas fa-check"></i> نعم، أنه الاختبار
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    
    <script>
        // قاعدة بيانات الأسئلة
        const quizQuestions = [
            // الأخطاء النحوية (1-10)
            {
                id: 1,
                type: 'multiple',
                question: 'الصواب في استخدام "ال" مع كلمة "غير" هو قول:',
                options: [
                    'الغير مناسب',
                    'غير المناسب',
                    'غير مناسباً'
                ],
                answer: 'غير المناسب',
                explanation: 'كلمة "غير" اسم ملازم للإضافة، فلا تقبل "ال" التعريف'
            },
            {
                id: 2,
                type: 'truefalse',
                question: 'يُعد تعبير "حاز على الجائزة" تعبيراً صحيحاً فصيحاً.',
                answer: 'خطأ',
                explanation: 'الصواب: "حاز الجائزة" لأن الفعل "حاز" لا يتعدى بحرف الجر'
            },
            {
                id: 3,
                type: 'multiple',
                question: 'عند استخدام "كلما" في جملة الشرط، الصواب هو:',
                options: [
                    'تكرارها (كلما... كلما)',
                    'ذكرها مرة واحدة في البداية',
                    'حذفها تماماً'
                ],
                answer: 'ذكرها مرة واحدة في البداية'
            },
            {
                id: 4,
                type: 'truefalse',
                question: 'يُقال "اعتاد على التفوق" والصواب نحويًا "اعتاد التفوق".',
                answer: 'صح'
            },
            {
                id: 5,
                type: 'multiple',
                question: 'الصواب في الفعل "استبدل" هو أن تدخل الباء على:',
                options: [
                    'الشيء المأخوذ',
                    'الشيء المتروك (القديم)',
                    'الفاعل'
                ],
                answer: 'الشيء المتروك (القديم)'
            },
            {
                id: 6,
                type: 'truefalse',
                question: 'يُعد قول "أجرى الباحث دراساتٍ معمقةٍ" صحيحاً بتنوين الكسر في "معمقة".',
                answer: 'خطأ',
                explanation: 'الصواب: "معمقةً" (تنوين النصب لأنها حال)'
            },
            {
                id: 7,
                type: 'multiple',
                question: 'يُقال في الأخبار "كشفت مصادر عن اعتزام..." والصواب:',
                options: [
                    'كشفت مصادر اعتزام',
                    'كشفت مصادر باعتزام',
                    'كشفت مصادر في اعتزام'
                ],
                answer: 'كشفت مصادر باعتزام'
            },
            {
                id: 8,
                type: 'truefalse',
                question: 'تعبير "بالرغم من" يُفضل استبداله بكلمة "رغم" أو "على الرغم".',
                answer: 'صح'
            },
            {
                id: 9,
                type: 'multiple',
                question: 'عند نداء الأسماء، يُقال:',
                options: [
                    'يسمى ماجدٌ',
                    'يسمى ماجداً',
                    'يسمى ماجدٍ'
                ],
                answer: 'يسمى ماجداً'
            },
            {
                id: 10,
                type: 'truefalse',
                question: 'كلمة "غير" لا تقبل "ال" التعريف لأنها اسم ملازم للإضافة.',
                answer: 'صح'
            },

            // الإعراب والبناء (11-20)
            {
                id: 11,
                type: 'multiple',
                question: 'العلم الذي يبحث في أصول تركيب الجملة وتفاعل الكلمات داخلها هو:',
                options: [
                    'الصرف',
                    'النحو',
                    'الدلالة'
                ],
                answer: 'النحو'
            },
            {
                id: 12,
                type: 'truefalse',
                question: 'جميع الحروف في اللغة العربية مبنية دائماً.',
                answer: 'صح'
            },
            {
                id: 13,
                type: 'multiple',
                question: '"البناء" هو لزوم اللفظ حالة واحدة لا تتغير مهما اختلف موقعه في:',
                options: [
                    'المعجم',
                    'الجملة',
                    'البيت الشعري'
                ],
                answer: 'الجملة'
            },
            {
                id: 14,
                type: 'truefalse',
                question: 'الفعل الماضي مبني دائماً.',
                answer: 'صح'
            },
            {
                id: 15,
                type: 'multiple',
                question: 'تُقدر الحركات الإعرابية للثقل في الفعل المنتهي بـ:',
                options: [
                    'الألف',
                    'الياء أو الواو',
                    'الهمزة'
                ],
                answer: 'الياء أو الواو'
            },
            {
                id: 16,
                type: 'truefalse',
                question: 'الإعراب المحلي خاص بالجمل وشبه الجمل.',
                answer: 'صح'
            },
            {
                id: 17,
                type: 'multiple',
                question: 'علامة الرفع الفرعية في الأسماء الخمسة هي:',
                options: [
                    'الألف',
                    'الواو',
                    'ثبوت النون'
                ],
                answer: 'الواو'
            },
            {
                id: 18,
                type: 'truefalse',
                question: 'الجر خاص بالأسماء والجزم خاص بالأفعال.',
                answer: 'صح'
            },
            {
                id: 19,
                type: 'multiple',
                question: 'يُبنى الفعل المضارع إذا اتصلت به:',
                options: [
                    'نون النسوة أو نون التوكيد',
                    'تاء الفاعل',
                    'ألف الاثنين'
                ],
                answer: 'نون النسوة أو نون التوكيد'
            },
            {
                id: 20,
                type: 'truefalse',
                question: 'النحو الحديث يعتبر الجملة التي فيها فعل "جملة فعلية" بغض النظر عن موقعه.',
                answer: 'صح'
            },

            // الممنوع من الصرف (21-30)
            {
                id: 21,
                type: 'multiple',
                question: 'الممنوع من الصرف هو الاسم الذي:',
                options: [
                    'لا يُنون ويُجر بالكسرة',
                    'لا يُنون ويُجر بالفتحة',
                    'يُنون ويُجر بالفتحة'
                ],
                answer: 'لا يُنون ويُجر بالفتحة'
            },
            {
                id: 22,
                type: 'truefalse',
                question: 'يُمنع العلم من الصرف إذا كان "مفرداً" (غير مضاف ولا معرف بـ ال).',
                answer: 'صح'
            },
            {
                id: 23,
                type: 'multiple',
                question: 'يُجر الممنوع من الصرف بالكسرة إذا:',
                options: [
                    'كان نكرة',
                    'عُرف بـ "ال" أو أُضيف',
                    'كان علماً أعجمياً'
                ],
                answer: 'عُرف بـ "ال" أو أُضيف'
            },
            {
                id: 24,
                type: 'truefalse',
                question: 'كلمة "بغداد" تمنع من الصرف لأنها علم أعجمي أو مؤنث زائد عن 3 أحرف.',
                answer: 'صح'
            },
            {
                id: 25,
                type: 'multiple',
                question: 'الأسماء (عثمان، مهدان، سكران) منعت من الصرف لوجود:',
                options: [
                    'الهمزة',
                    'الألف والنون الزائدتين',
                    'التضعيف'
                ],
                answer: 'الألف والنون الزائدتين'
            },
            {
                id: 26,
                type: 'truefalse',
                question: 'يُمنع العلم "أحمد" من الصرف لأنه على وزن الفعل.',
                answer: 'صح'
            },
            {
                id: 27,
                type: 'multiple',
                question: 'صيغ منتهى الجموع هي كل جمع تكسير بعد ألف تكسيره:',
                options: [
                    'حرف واحد',
                    'حرفان أو ثلاثة',
                    'أربعة أحرف'
                ],
                answer: 'حرفان أو ثلاثة'
            },
            {
                id: 28,
                type: 'truefalse',
                question: 'الاسم المقصور (مثل ليلى) لا يتأثر بنظرية المفرد لأن حركته مقدرة للتعذر.',
                answer: 'صح'
            },
            {
                id: 29,
                type: 'multiple',
                question: 'تمنع الصفة على وزن "أفعل" من الصرف مثل:',
                options: [
                    'كريم',
                    'أحسن',
                    'عظيم'
                ],
                answer: 'أحسن'
            },
            {
                id: 30,
                type: 'truefalse',
                question: 'كلمة "عُمر" تمنع من الصرف لأنها علم معدول عن "عامر" حسب النحاة.',
                answer: 'صح'
            },

            // إن وأخواتها (31-40)
            {
                id: 31,
                type: 'multiple',
                question: '"ليت" حرف مركب من:',
                options: [
                    'لـ + أيت',
                    'لا + أيت',
                    'لن + أيت'
                ],
                answer: 'لـ + أيت'
            },
            {
                id: 32,
                type: 'truefalse',
                question: 'إن وأخواتها تدخل على الجملة الاسمية فترفع المبتدأ وتنصب الخبر.',
                answer: 'خطأ',
                explanation: 'تنصب المبتدأ وترفع الخبر'
            },
            {
                id: 33,
                type: 'multiple',
                question: '"لعل" حرف ناسخ أصله اللغوي:',
                options: [
                    'لـ + عل',
                    'لن + عل',
                    'لا + عل'
                ],
                answer: 'لـ + عل'
            },
            {
                id: 34,
                type: 'truefalse',
                question: 'يجوز تقديم خبر "إن" على اسمها إذا كان شبه جملة.',
                answer: 'صح'
            },
            {
                id: 35,
                type: 'multiple',
                question: 'نون الوقاية تدخل على "ليت" فيُقال غالباً:',
                options: [
                    'ليتي',
                    'ليتني',
                    'ليتنني'
                ],
                answer: 'ليتني'
            },
            {
                id: 36,
                type: 'truefalse',
                question: '"كأن" مركبة من كاف التشبيه و"أنّ".',
                answer: 'صح'
            },
            {
                id: 37,
                type: 'multiple',
                question: 'خبر إن في قوله {إن مع العسر يسراً} هو:',
                options: [
                    'يسراً',
                    'مع العسر (شبه جملة)',
                    'ضمير مستتر'
                ],
                answer: 'مع العسر (شبه جملة)'
            },
            {
                id: 38,
                type: 'truefalse',
                question: '"لكنّ" مركبة من "لا" و"كأن".',
                answer: 'خطأ',
                explanation: 'مركبة من أداة تنبيه + إن'
            },
            {
                id: 39,
                type: 'multiple',
                question: 'تعمل إن وأخواتها في الجملة:',
                options: [
                    'الفعلية',
                    'الاسمية',
                    'شبه الجملة'
                ],
                answer: 'الاسمية'
            },
            {
                id: 40,
                type: 'truefalse',
                question: 'يجوز في اللغة "إني" و"إنني" حسب اختلاف اللهجات.',
                answer: 'صح'
            },

            // نظام التعدية في النحو العربي (41-50)
            {
                id: 41,
                type: 'multiple',
                question: 'الفعل الذي يكتفي بفاعله ولا يحتاج لمفعول به يسمى:',
                options: [
                    'متعدياً',
                    'لازماً',
                    'ناقصاً'
                ],
                answer: 'لازماً'
            },
            {
                id: 42,
                type: 'truefalse',
                question: 'يمكن تعدية الفعل اللازم بزيادة همزة في أوله (مثل: أكرم).',
                answer: 'صح'
            },
            {
                id: 43,
                type: 'multiple',
                question: 'الفعل "أعلم" يتعدى لـ:',
                options: [
                    'مفعول واحد',
                    'مفعولين',
                    'ثلاثة مفاعيل'
                ],
                answer: 'ثلاثة مفاعيل'
            },
            {
                id: 44,
                type: 'truefalse',
                question: 'حروف التعدية في اللغة السبئية القديمة هي "الهاء" مثل (هريقوا).',
                answer: 'صح'
            },
            {
                id: 45,
                type: 'multiple',
                question: 'الفعل "رأى" ينصب مفعولين إذا كانت الرؤية:',
                options: [
                    'بصرية حسية',
                    'قلبية ذهنية',
                    'منامية'
                ],
                answer: 'قلبية ذهنية'
            },
            {
                id: 46,
                type: 'truefalse',
                question: 'الشين هي حرف التعدية في اللغة الحضرمية والأكدية.',
                answer: 'صح'
            },
            {
                id: 47,
                type: 'multiple',
                question: 'أفعال التحويل (مثل: جعل، صيّر) تنصب:',
                options: [
                    'مفعولاً واحداً',
                    'مفعولين أصلهما مبتدأ وخبر',
                    'لا تنصب مفاعيل'
                ],
                answer: 'مفعولين أصلهما مبتدأ وخبر'
            },
            {
                id: 48,
                type: 'truefalse',
                question: 'الفعل "حاز" يتعدى بنفسه ولا يحتاج لحرف الجر "على".',
                answer: 'صح'
            },
            {
                id: 49,
                type: 'multiple',
                question: 'وسيلة التعدية في "درّس" هي:',
                options: [
                    'الهمزة',
                    'التضعيف (تشديد العين)',
                    'زيادة الألف'
                ],
                answer: 'التضعيف (تشثير العين)'
            },
            {
                id: 50,
                type: 'truefalse',
                question: 'الفعل "وجد" ينصب مفعولين إذا كان بمعنى "عثر على شيء مادي".',
                answer: 'خطأ',
                explanation: 'في هذه الحالة يعرب الثاني حالاً وليس مفعولاً ثانياً'
            },

            // الأخطاء الدلالية (51-60)
            {
                id: 51,
                type: 'multiple',
                question: 'كلمة "توأم" في اللغة تعني:',
                options: [
                    'فرداً واحداً',
                    'اثنين',
                    'ثلاثة'
                ],
                answer: 'اثنين'
            },
            {
                id: 52,
                type: 'truefalse',
                question: 'قول "امرأة تنجب توأمين" يعني أنها أنجبت أربعة أطفال.',
                answer: 'صح'
            },
            {
                id: 53,
                type: 'multiple',
                question: '"معنى المعنى" للفعل "ضرب" في (ضرب في الأرض) هو:',
                options: [
                    'أوجع',
                    'سافر',
                    'خفق'
                ],
                answer: 'سافر'
            },
            {
                id: 54,
                type: 'truefalse',
                question: 'يُعد تعبير "الأحبال الصوتية" صحيحاً دلالياً.',
                answer: 'خطأ',
                explanation: 'الصواب: "الوتران الصوتيان"'
            },
            {
                id: 55,
                type: 'multiple',
                question: 'المثلثات اللغوية (مثل قَسط، قِسط، قُسط) يتغير معناها بتغير:',
                options: [
                    'عدد حروفها',
                    'حركتها الإعرابية',
                    'ترتيب حروفها'
                ],
                answer: 'حركتها الإعرابية'
            },
            {
                id: 56,
                type: 'truefalse',
                question: 'الحشو هو زيادة في المبنى لا يقابلها زيادة في المعنى.',
                answer: 'صح'
            },
            {
                id: 57,
                type: 'multiple',
                question: 'تعبير "التهاني القلبية" يُعد من قبيل:',
                options: [
                    'الإيجاز',
                    'الحشو',
                    'التفاصح'
                ],
                answer: 'الحشو'
            },
            {
                id: 58,
                type: 'truefalse',
                question: 'قولنا "تعادل الفريقان بهدفين لكل منهما" يحتوي على حشو.',
                answer: 'صح'
            },
            {
                id: 59,
                type: 'multiple',
                question: 'الصواب في ترجمة "I am as a writer" هو:',
                options: [
                    'أنا ككاتب',
                    'أنا بصفتي كاتباً',
                    'أنا مثل كاتب'
                ],
                answer: 'أنا بصفتي كاتباً'
            },
            {
                id: 60,
                type: 'truefalse',
                question: 'كلمة "قَسط" بفتح القاف تعني العدل.',
                answer: 'خطأ',
                explanation: 'تعني الظلم (قِسط بكسر القاف تعني العدل)'
            },

            // التفاصح (61-70)
            {
                id: 61,
                type: 'multiple',
                question: 'التفاصح هو ظاهرة لغوية ناتجة عن:',
                options: [
                    'الجهل باللغة',
                    'توهم المتكلم أن لغته غير فصيحة فيحاول "تفصيحها" خطأً',
                    'الرغبة في التحدث بالعامية'
                ],
                answer: 'توهم المتكلم أن لغته غير فصيحة فيحاول "تفصيحها" خطأً'
            },
            {
                id: 62,
                type: 'truefalse',
                question: 'نطق "السين" ثاءً (مثل: يتثنى بدلاً من يتسنى) يُعد من التفاصح الصوتي.',
                answer: 'صح'
            },
            {
                id: 63,
                type: 'multiple',
                question: 'من التفاصح الصرفي "همز ما لا يهمز" مثل قول:',
                options: [
                    'مارب',
                    'مأرب',
                    'ميرب'
                ],
                answer: 'مأرب'
            },
            {
                id: 64,
                type: 'truefalse',
                question: 'الصواب في وصف الشريعة قولنا "الشريعة السمحاء".',
                answer: 'خطأ',
                explanation: 'الصواب: "السمحة" لأن صيغة فعلى للمبالغة لا تصلح للعلم المؤنث'
            },
            {
                id: 65,
                type: 'multiple',
                question: 'القاعدة في العدد (11-19) هي البناء على:',
                options: [
                    'السكون',
                    'فتح الجزأين',
                    'الضم'
                ],
                answer: 'فتح الجزأين'
            },
            {
                id: 66,
                type: 'truefalse',
                question: 'جر الممنوع من الصرف بالكسرة (مثل: في مناطقٍ) يُعد من أخطاء التفاصح.',
                answer: 'صح'
            },
            {
                id: 67,
                type: 'multiple',
                question: 'نطق "مشايخ" بالهمزة "مشائخ" هو:',
                options: [
                    'صواب فصيح',
                    'خطأ تفاصحي',
                    'لهجة قديمة'
                ],
                answer: 'خطأ تفاصحي'
            },
            {
                id: 68,
                type: 'truefalse',
                question: 'التفاصح قد يكون في النطق وقد يكون في الكتابة.',
                answer: 'صح'
            },
            {
                id: 69,
                type: 'multiple',
                question: 'نطق "الزاي" ذالاً (مثل: ذبيب بدلاً من زبيب) هو خطأ:',
                options: [
                    'نحوي',
                    'صوتي',
                    'دلالي'
                ],
                answer: 'صوتي'
            },
            {
                id: 70,
                type: 'truefalse',
                question: 'الصواب هو "مشايخ" و"معايب" و"مصايد" بالياء لا بالهمزة.',
                answer: 'صح'
            },

            // مقدمة (تاريخ التدوين) (71-80)
            {
                id: 71,
                type: 'multiple',
                question: 'تدوين القرآن وصناعة المصحف في عهد عثمان بن عفان كان في عام:',
                options: [
                    '15 هـ',
                    '25 هـ',
                    '35 هـ'
                ],
                answer: '25 هـ'
            },
            {
                id: 72,
                type: 'truefalse',
                question: 'يُعتبر تدوين القرآن أعظم مشروع استراتيجي لأنه حفظ النص من التحريف.',
                answer: 'صح'
            },
            {
                id: 73,
                type: 'multiple',
                question: 'مخترعو الكتابة الأوائل هم:',
                options: [
                    'الفينيقيون',
                    'السومريون (الشومريون)',
                    'الرومان'
                ],
                answer: 'السومريون (الشومريون)'
            },
            {
                id: 74,
                type: 'truefalse',
                question: '"الشومريون" هم قبائل يمنية هاجرت واستوطنت العراق.',
                answer: 'صح'
            },
            {
                id: 75,
                type: 'multiple',
                question: 'اعتمدت لجنة تدوين المصحف لغة:',
                options: [
                    'تميم',
                    'قريش',
                    'حمير'
                ],
                answer: 'قريش'
            },
            {
                id: 76,
                type: 'truefalse',
                question: 'نظام الإملاء في المصحف كان مزيجاً من الإملاء اليمني والعراقي السوري.',
                answer: 'صح'
            },
            {
                id: 77,
                type: 'multiple',
                question: 'اقترح المصدر مصطلح "اللغات النوحية" كبديل لمصطلح:',
                options: [
                    'اللغات السامية',
                    'اللغات الحامية',
                    'اللغات الآرية'
                ],
                answer: 'اللغات السامية'
            },
            {
                id: 78,
                type: 'truefalse',
                question: 'كانت نسبة الأمية في المجتمعات القديمة قبل الإسلام تتجاوز 80%.',
                answer: 'صح'
            },
            {
                id: 79,
                type: 'multiple',
                question: 'المرحلة الأولى من مراحل الكتابة هي:',
                options: [
                    'الرموز',
                    'التصوير',
                    'المقاطع'
                ],
                answer: 'التصوير'
            },
            {
                id: 80,
                type: 'truefalse',
                question: 'الخط العربي في أصله مأخوذ من الخط الآرامي النبطي.',
                answer: 'صح'
            },

            // الإملاء وعلوم اللغة (81-90)
            {
                id: 81,
                type: 'multiple',
                question: 'تكتب الهمزة المتوسطة قبل الضمير على الواو (مثل: أصدقاؤنا) في حالة:',
                options: [
                    'النصب',
                    'الرفع',
                    'الجر'
                ],
                answer: 'الرفع'
            },
            {
                id: 82,
                type: 'truefalse',
                question: 'يتحدد شكل الألف في نهاية الفعل (ممدودة أو مقصورة) بحسب أصله الصرفي.',
                answer: 'صح'
            },
            {
                id: 83,
                type: 'multiple',
                question: 'القاعدة "الذهبية" الأولى في الإملاء هي اعتماد شكل الحرف بناءً على:',
                options: [
                    'طول الكلمة',
                    'الحركة الأقوى',
                    'نوع الحبر'
                ],
                answer: 'الحركة الأقوى'
            },
            {
                id: 84,
                type: 'truefalse',
                question: 'تُحذف ياء الاسم المنقوص (مثل: قاضٍ) إذا كان "مفرداً" في حالتي الرفع والجر.',
                answer: 'صح'
            },
            {
                id: 85,
                type: 'multiple',
                question: 'تُرسم الألف ممدودة "علوية" (مثل: دنا) إذا كان أصلها:',
                options: [
                    'ياءً',
                    'واواً',
                    'ألفاً'
                ],
                answer: 'واواً'
            },
            {
                id: 86,
                type: 'truefalse',
                question: 'يفرق الإملاء دلالياً بين "ندا" (مذكر) و"ندى" (مؤنث).',
                answer: 'صح'
            },
            {
                id: 87,
                type: 'multiple',
                question: 'قاعدة "كراهة توالي الأمثال" تعني منع كتابة:',
                options: [
                    'حرفين مختلفين',
                    'حرفين متطابقين متتاليين',
                    'أكثر من ثلاث كلمات'
                ],
                answer: 'حرفين متطابقين متتاليين'
            },
            {
                id: 88,
                type: 'truefalse',
                question: 'تُرسم الهمزة المتوسطة على السطر (مثل: أصدقاءنا) في حالة النصب.',
                answer: 'صح'
            },
            {
                id: 89,
                type: 'multiple',
                question: 'الحركة الأقوى في سلم الحركات الإملائية هي:',
                options: [
                    'الضمة',
                    'الكسرة',
                    'الفتحة'
                ],
                answer: 'الكسرة'
            },
            {
                id: 90,
                type: 'truefalse',
                question: 'علم الدلالة يساعد في التمييز بين "عَال" (مفرد) و"عُلى" (جمع) إملائياً.',
                answer: 'صح'
            },

            // مشكلات الإملاء في اللغة العربية (91-100)
            {
                id: 91,
                type: 'multiple',
                question: 'أكبر معضلة في الإملاء العربي هي:',
                options: [
                    'حرف الميم',
                    'الهمزة',
                    'اللام القمرية'
                ],
                answer: 'الهمزة'
            },
            {
                id: 92,
                type: 'truefalse',
                question: 'أضيفت الألف في كلمة "مائة" قديماً لتمييزها عن كلمات مثل "فئة" قبل اختراع النقط.',
                answer: 'صح'
            },
            {
                id: 93,
                type: 'multiple',
                question: 'يُقترح في الإملاء الحديث كتابة "مئة" بدون ألف لـ:',
                options: [
                    'تحقيق التوافق بين النطق والمكتوب',
                    'اختصار الوقت',
                    'تجميل الخط'
                ],
                answer: 'تحقيق التوافق بين النطق والمكتوب'
            },
            {
                id: 94,
                type: 'truefalse',
                question: 'من مشكلات الإملاء رسم الحرف الواحد بأكثر من شكل كالهمزة.',
                answer: 'صح'
            },
            {
                id: 95,
                type: 'multiple',
                question: 'أول من فطن لقانون "توالي الأمثال" في الخط هو:',
                options: [
                    'سيبويه',
                    'ابن درستويه',
                    'الفراء'
                ],
                answer: 'الفراء'
            },
            {
                id: 96,
                type: 'truefalse',
                question: 'ازدواجية اللغة بين الفصحى والعامية تؤدي لخلط المتعلمين بين الأصوات المتشابهة.',
                answer: 'صح'
            },
            {
                id: 97,
                type: 'multiple',
                question: 'وضع الخليل بن أحمد رمز الهمزة لتحقيق:',
                options: [
                    'التباعد بين الكلمات',
                    'التطابق بين الكتابة والنطق',
                    'سرعة الكتابة'
                ],
                answer: 'التطابق بين الكتابة والنطق'
            },
            {
                id: 98,
                type: 'truefalse',
                question: 'المجمع اللغوي السوري يرى وجوب مطابقة المنطوق للمكتوب ما أمكن.',
                answer: 'صح'
            },
            {
                id: 99,
                type: 'multiple',
                question: 'يكتب المصريون الألف المقصورة "ياءً منقوطة" (مثل: علي) وهذا ناتج عن:',
                options: [
                    'نظام المخطوطات القديم',
                    'قاعدة حديثة',
                    'خطأ مطبعي'
                ],
                answer: 'نظام المخطوطات القديم'
            },
            {
                id: 100,
                type: 'truefalse',
                question: 'تُحذف همزة الوصل خطاً في "البسملة" الكاملة فقط.',
                answer: 'صح'
            },

            // أنواع الرسم العربي (101-110)
            {
                id: 101,
                type: 'multiple',
                question: 'الرسم الذي لا يجوز المساس به أو تعديله هو:',
                options: [
                    'الرسم الإملائي الحديث',
                    'الرسم القرآني (العثماني)',
                    'رسم المخطوطات العلمية'
                ],
                answer: 'الرسم القرآني (العثماني)'
            },
            {
                id: 102,
                type: 'truefalse',
                question: 'الرسم القرآني "موقوف" وتراث أمة وكتاب عقيدة.',
                answer: 'صح'
            },
            {
                id: 103,
                type: 'multiple',
                question: 'كلمة "يأيها" تُكتب في المصحف:',
                options: [
                    'منفصلة (يا أيها)',
                    'متصلة (يأيها)',
                    'بدون ألف'
                ],
                answer: 'متصلة (يأيها)'
            },
            {
                id: 104,
                type: 'truefalse',
                question: 'أفتى الإمام مالك بمنع كتابة المصحف على ما أحدثه الناس من قواعد هجاء.',
                answer: 'صح'
            },
            {
                id: 105,
                type: 'multiple',
                question: 'الفرق بين الرسمين يظهر في حذف أو زيادة أحرف لغرض:',
                options: [
                    'الزينة',
                    'التوقيف الشرعي في المصحف',
                    'السرعة'
                ],
                answer: 'التوقيف الشرعي في المصحف'
            },
            {
                id: 106,
                type: 'truefalse',
                question: 'يُعتبر توحيد رسم "الضاد والظاء" دعوة مرفوضة لفساد المعنى الدلالي.',
                answer: 'صح'
            },
            {
                id: 107,
                type: 'multiple',
                question: 'الرسم القرآني يعتمد أحياناً على:',
                options: [
                    'تسهيل الهمز (لهجة قريش)',
                    'تشديد كل الحروف',
                    'الخط الكوفي فقط'
                ],
                answer: 'تسهيل الهمز (لهجة قريش)'
            },
            {
                id: 108,
                type: 'truefalse',
                question: 'يُمنع الاجتهاد في رسم المصحف حتى لو كان لغرض التعليم.',
                answer: 'صح'
            },
            {
                id: 109,
                type: 'multiple',
                question: 'كتابة "مائة" بالألف هي من خصائص:',
                options: [
                    'الإملاء الحديث فقط',
                    'الرسم القرآني والقديم',
                    'الصحافة'
                ],
                answer: 'الرسم القرآني والقديم'
            },
            {
                id: 110,
                type: 'truefalse',
                question: 'الرسم الإملائي الحديث يهدف لتجاوز الحالات الشاذة وجعل القواعد مطردة.',
                answer: 'صح'
            },

            // الإملاء والألف (111-120)
            {
                id: 111,
                type: 'multiple',
                question: 'تُزاد الألف (ألف الإطلاق) في نهاية:',
                options: [
                    'الأسماء',
                    'الأبيات الشعرية عند الحاجة',
                    'الأفعال المضارعة المرفوعة'
                ],
                answer: 'الأبيات الشعرية عند الحاجة'
            },
            {
                id: 112,
                type: 'truefalse',
                question: 'تُحذف ألف "ما" الاستفهامية إذا سبقت بحرف جر (مثل: بِمَ، عَمَّ).',
                answer: 'صح'
            },
            {
                id: 113,
                type: 'multiple',
                question: 'تُكتب الألف "سفلية" (مقصورة) في الأفعال:',
                options: [
                    'الثلاثية التي أصلها واو',
                    'فوق الثلاثية (الرباعي والخماسي) مطلقاً (مثل: أعطى)',
                    'التي تنتهي بهمزة'
                ],
                answer: 'فوق الثلاثية (الرباعي والخماسي) مطلقاً (مثل: أعطى)'
            },
            {
                id: 114,
                type: 'truefalse',
                question: 'تُكتب الألف ممدودة في كلمة "لكن".',
                answer: 'خطأ',
                explanation: 'تُنطق ولا تُكتب'
            },
            {
                id: 115,
                type: 'multiple',
                question: 'تُزاد "الألف الفارقة" بعد واو الجماعة في:',
                options: [
                    'جمع المذكر السالم (مهندسو)',
                    'الأفعال (مثل: لم يفعلوا)',
                    'الأسماء الخمسة'
                ],
                answer: 'الأفعال (مثل: لم يفعلوا)'
            },
            {
                id: 116,
                type: 'truefalse',
                question: 'تُحذف الألف خطاً في كلمات (إله، طه، الرحمن) بالرسم القرآني.',
                answer: 'صح'
            },
            {
                id: 117,
                type: 'multiple',
                question: 'تُكتب الألف مقصورة سفلية إذا كان قبلها ياء في اسم العلم:',
                options: [
                    'يحيى',
                    'ثريا',
                    'دنيا'
                ],
                answer: 'يحيى'
            },
            {
                id: 118,
                type: 'truefalse',
                question: 'تُكتب "ها أنذا" بحذف ألف "أنا" لتجنب توالي ثلاث ألفات.',
                answer: 'صح'
            },
            {
                id: 119,
                type: 'multiple',
                question: 'كلمة "إذن" الصواب كتابتها بالنون لـ:',
                options: [
                    'تمييزها عن "إذا" الشرطية',
                    'تسهيل النطق',
                    'اتباع رسم المصحف'
                ],
                answer: 'تمييزها عن "إذا" الشرطية'
            },
            {
                id: 120,
                type: 'truefalse',
                question: 'تُكتب الألف في أسماء الأعلام الأعجمية (مثل: أمريكا، آسيا) ممدودة غالباً.',
                answer: 'صح'
            }
        ];

        // ثوابت التطبيق
        const TOTAL_QUESTIONS_IN_DB = 120;
        const QUESTIONS_TO_SELECT = 30;
        function selectRandomQuestions() {
            let available = quizQuestions.filter(q => !usedQuestionIds.has(q.id));
            if (available.length < QUESTIONS_TO_SELECT) {
                let used = quizQuestions.filter(q => usedQuestionIds.has(q.id));
                const needed = QUESTIONS_TO_SELECT - available.length;
                const randomUsed = shuffleArray([...used]).slice(0, needed);
                available = [...available, ...randomUsed];
                usedQuestionIds.clear();
            }
            currentQuestions = shuffleArray(available).slice(0, QUESTIONS_TO_SELECT);
            currentQuestions.forEach(q => usedQuestionIds.add(q.id));
            userAnswers = new Array(currentQuestions.length).fill(null);
        }
        
        function shuffleAllOptions() {
            shuffledQuestions = currentQuestions.map(q => {
                if (q.type === 'multiple') {
                    const opts = [...q.options];
                    const correctText = q.answer;
                    // خلط الخيارات
                    for (let i = opts.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [opts[i], opts[j]] = [opts[j], opts[i]];
                    }
                    return {
                        ...q,
                        shuffledOptions: opts,
                        shuffledCorrect: opts.indexOf(correctText)
                    };
                } else { // true/false
                    return {
                        ...q,
                        shuffledOptions: ['صح', 'خطأ'],
                        shuffledCorrect: q.answer === 'صح' ? 0 : 1
                    };
                }
            });
        }
        
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
    
    <script src="exam-common.js"></script>
</body>
</html>